<span>benchmarkUtilities.ts</span><pre class="shiki" style="background-color: #1b1b1d"><code><span class="line"><span style="color: #888589; font-style: italic">// @filename: benchmarkUtilities.ts</span></span>
<span class="line"><span style="color: #DF61ED">import</span><span style="color: #BEBABF"> </span><span style="color: #DF61ED">type</span><span style="color: #BEBABF"> { </span><span style="color: #ED616F">CaseResult</span><span style="color: #BEBABF">, </span><span style="color: #ED616F">Summary</span><span style="color: #BEBABF"> } </span><span style="color: #DF61ED">from</span><span style="color: #BEBABF"> </span><span style="color: #61ED99">&#39;benny/lib/internal/common-types&#39;</span><span style="color: #BEBABF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #888589; font-style: italic">/**</span></span>
<span class="line"><span style="color: #888589; font-style: italic"> * Adds an ordinal sufix (ex. 1st, 2nd, 3rd) to a number</span></span>
<span class="line"><span style="color: #888589; font-style: italic"> *</span></span>
<span class="line"><span style="color: #888589; font-style: italic"> * </span><span style="color: #DF61ED; font-style: italic">@param</span><span style="color: #888589; font-style: italic"> </span><span style="color: #ED616F; font-style: italic">n</span><span style="color: #888589; font-style: italic"> - the number to add the suffix to</span></span>
<span class="line"><span style="color: #888589; font-style: italic"> * </span><span style="color: #DF61ED; font-style: italic">@param</span><span style="color: #888589; font-style: italic"> </span><span style="color: #ED616F; font-style: italic">radix</span><span style="color: #888589; font-style: italic"> - the number base for the toString method</span></span>
<span class="line"><span style="color: #888589; font-style: italic"> * </span><span style="color: #DF61ED; font-style: italic">@returns</span><span style="color: #888589; font-style: italic"> an ordinal number</span></span>
<span class="line"><span style="color: #888589; font-style: italic"> */</span></span>
<span class="line"><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #61B5ED">ordinalSuffix</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> (</span><span style="color: #ED616F; font-style: italic">n</span><span style="color: #BEBABF">: </span><span style="color: #EDDF61">number</span><span style="color: #BEBABF">, </span><span style="color: #ED616F; font-style: italic">radix</span><span style="color: #DF61ED">?</span><span style="color: #BEBABF">: </span><span style="color: #EDDF61">number</span><span style="color: #BEBABF">): </span><span style="color: #EDDF61">string</span><span style="color: #BEBABF"> </span><span style="color: #DF61ED">=&gt;</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #61ED99">`</span><span style="color: #DF61ED">${</span><span style="color: #ED616F">n</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">toString</span><span style="color: #BEBABF">(</span><span style="color: #ED616F">radix</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}${</span></span>
<span class="line"><span style="color: #BEBABF">        [</span><span style="color: #61ED99">&#39;st&#39;</span><span style="color: #BEBABF">, </span><span style="color: #61ED99">&#39;nd&#39;</span><span style="color: #BEBABF">, </span><span style="color: #61ED99">&#39;rd&#39;</span><span style="color: #BEBABF">][((((</span><span style="color: #ED616F">n</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">+</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">90</span><span style="color: #BEBABF">) </span><span style="color: #61EDDF">%</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">100</span><span style="color: #BEBABF">) </span><span style="color: #61EDDF">-</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">10</span><span style="color: #BEBABF">) </span><span style="color: #61EDDF">%</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">10</span><span style="color: #BEBABF">) </span><span style="color: #61EDDF">-</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">1</span><span style="color: #BEBABF">] </span><span style="color: #61EDDF">||</span><span style="color: #BEBABF"> </span><span style="color: #61ED99">&#39;th&#39;</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">}</span><span style="color: #61ED99">`</span><span style="color: #BEBABF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">format</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> </span><span style="color: #DF61ED">new</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">Intl</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">NumberFormat</span><span style="color: #BEBABF">().</span><span style="color: #ED616F">format</span><span style="color: #BEBABF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #61B5ED">resultTag</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> &lt;</span><span style="color: #EDDF61">resultType</span><span style="color: #BEBABF"> </span><span style="color: #DF61ED">extends</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">CaseResult</span><span style="color: #BEBABF">&gt;(</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #ED616F; font-style: italic">_result</span><span style="color: #BEBABF">: </span><span style="color: #EDDF61">resultType</span><span style="color: #BEBABF">,</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #ED616F">nameSpace</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">0</span><span style="color: #BEBABF">,</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #ED616F">opSpace</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">0</span></span>
<span class="line"><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #61ED99">`</span><span style="color: #DF61ED">${</span><span style="color: #61ED99">`</span><span style="color: #DF61ED">${</span><span style="color: #ED616F">_result</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">name</span><span style="color: #DF61ED">}</span><span style="color: #61ED99">:`</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">padEnd</span><span style="color: #BEBABF">(</span><span style="color: #ED616F">nameSpace</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">+</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">1</span><span style="color: #BEBABF">, </span><span style="color: #61ED99">&#39; &#39;</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}</span><span style="color: #61ED99"> </span><span style="color: #DF61ED">${</span><span style="color: #61B5ED">format</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">        </span><span style="color: #61EDDF">+</span><span style="color: #ED616F">_result</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">ops</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">toFixed</span><span style="color: #BEBABF">(</span><span style="color: #ED9961">0</span><span style="color: #BEBABF">)</span></span>
<span class="line"><span style="color: #BEBABF">    ).</span><span style="color: #61B5ED">padStart</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">        </span><span style="color: #ED616F">opSpace</span></span>
<span class="line"><span style="color: #BEBABF">    )</span><span style="color: #DF61ED">}</span><span style="color: #61ED99"> operations/second Â±</span><span style="color: #DF61ED">${</span><span style="color: #ED616F">_result</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">details</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">relativeMarginOfError</span></span>
<span class="line"><span style="color: #BEBABF">        .</span><span style="color: #61B5ED">toFixed</span><span style="color: #BEBABF">(</span><span style="color: #ED9961">2</span><span style="color: #BEBABF">)</span></span>
<span class="line"><span style="color: #BEBABF">        .</span><span style="color: #61B5ED">padStart</span><span style="color: #BEBABF">(</span><span style="color: #ED9961">6</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}</span><span style="color: #61ED99">%`</span><span style="color: #BEBABF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #DF61ED">export</span><span style="color: #BEBABF"> </span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #61B5ED">summarize</span><span style="color: #BEBABF">: (</span><span style="color: #ED616F; font-style: italic">summary</span><span style="color: #BEBABF">: </span><span style="color: #EDDF61">Summary</span><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">void</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> (</span><span style="color: #ED616F; font-style: italic">_summary</span><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span><span style="color: #BEBABF"> {</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">longestName</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">Math</span><span style="color: #BEBABF">.</span><span style="color: #61EDDF">max</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">        ...</span><span style="color: #ED616F">_summary</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">results</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">map</span><span style="color: #BEBABF">((</span><span style="color: #ED616F; font-style: italic">result</span><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span><span style="color: #BEBABF"> </span><span style="color: #ED616F">result</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">name</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">length</span><span style="color: #BEBABF">)</span></span>
<span class="line"><span style="color: #BEBABF">    );</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">longestOpCount</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">Math</span><span style="color: #BEBABF">.</span><span style="color: #61EDDF">max</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">        ...</span><span style="color: #ED616F">_summary</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">results</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">map</span><span style="color: #BEBABF">((</span><span style="color: #ED616F; font-style: italic">result</span><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span><span style="color: #BEBABF"> </span><span style="color: #ED616F">result</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">ops</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">toFixed</span><span style="color: #BEBABF">(</span><span style="color: #ED9961">0</span><span style="color: #BEBABF">).</span><span style="color: #ED616F">length</span><span style="color: #BEBABF">)</span></span>
<span class="line"><span style="color: #BEBABF">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">results</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> [</span><span style="color: #61ED99">&#39;&#39;</span><span style="color: #BEBABF">, </span><span style="color: #61ED99">`</span><span style="color: #DF61ED">${</span><span style="color: #ED616F">_summary</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">name</span><span style="color: #DF61ED">}</span><span style="color: #61ED99"> Results: `</span><span style="color: #BEBABF">, </span><span style="color: #61ED99">&#39;&#39;</span><span style="color: #BEBABF">];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">sortedResults</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> [...</span><span style="color: #ED616F">_summary</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">results</span><span style="color: #BEBABF">].</span><span style="color: #61B5ED">sort</span><span style="color: #BEBABF">((</span><span style="color: #ED616F; font-style: italic">a</span><span style="color: #BEBABF">, </span><span style="color: #ED616F; font-style: italic">b</span><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span><span style="color: #BEBABF"> </span><span style="color: #ED616F">b</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">ops</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">-</span><span style="color: #BEBABF"> </span><span style="color: #ED616F">a</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">ops</span><span style="color: #BEBABF">);</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">for</span><span style="color: #BEBABF"> (</span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> [</span><span style="color: #EDDF61">index</span><span style="color: #BEBABF">, </span><span style="color: #EDDF61">result</span><span style="color: #BEBABF">] </span><span style="color: #DF61ED">of</span><span style="color: #BEBABF"> </span><span style="color: #ED616F">sortedResults</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">entries</span><span style="color: #BEBABF">()) {</span></span>
<span class="line"><span style="color: #BEBABF">        </span><span style="color: #ED616F">results</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">push</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">            </span><span style="color: #61ED99">`</span><span style="color: #DF61ED">${</span><span style="color: #61B5ED">resultTag</span><span style="color: #BEBABF">(</span><span style="color: #ED616F">result</span><span style="color: #BEBABF">, </span><span style="color: #ED616F">longestName</span><span style="color: #BEBABF">, </span><span style="color: #ED616F">longestOpCount</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}</span><span style="color: #61ED99"> | </span><span style="color: #DF61ED">${</span></span>
<span class="line"><span style="color: #BEBABF">                </span><span style="color: #ED616F">index</span></span>
<span class="line"><span style="color: #BEBABF">                    </span><span style="color: #DF61ED">?</span><span style="color: #BEBABF"> </span><span style="color: #61ED99">`</span><span style="color: #DF61ED">${</span><span style="color: #61B5ED">ordinalSuffix</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">                            </span><span style="color: #ED616F">index</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">+</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">1</span></span>
<span class="line"><span style="color: #BEBABF">                      )</span><span style="color: #DF61ED">}</span><span style="color: #61ED99"> | </span><span style="color: #DF61ED">${</span><span style="color: #ED616F">result</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">percentSlower</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">toFixed</span><span style="color: #BEBABF">(</span><span style="color: #ED9961">2</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}</span><span style="color: #61ED99">% slower`</span></span>
<span class="line"><span style="color: #BEBABF">                    </span><span style="color: #DF61ED">:</span><span style="color: #BEBABF"> </span><span style="color: #61ED99">&#39;Fastest&#39;</span></span>
<span class="line"><span style="color: #BEBABF">            </span><span style="color: #DF61ED">}</span><span style="color: #61ED99">`</span></span>
<span class="line"><span style="color: #BEBABF">        );</span></span>
<span class="line"><span style="color: #BEBABF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #ED616F">results</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">push</span><span style="color: #BEBABF">(</span><span style="color: #61ED99">&#39;&#39;</span><span style="color: #BEBABF">);</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">longestResultString</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">Math</span><span style="color: #BEBABF">.</span><span style="color: #61EDDF">max</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">        ...</span><span style="color: #ED616F">results</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">map</span><span style="color: #BEBABF">((</span><span style="color: #ED616F; font-style: italic">value</span><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span><span style="color: #BEBABF"> </span><span style="color: #ED616F">value</span><span style="color: #BEBABF">.</span><span style="color: #ED616F">length</span><span style="color: #BEBABF">)</span></span>
<span class="line"><span style="color: #BEBABF">    );</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #DF61ED">const</span><span style="color: #BEBABF"> </span><span style="color: #EDDF61">modifiedResults</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">=</span><span style="color: #BEBABF"> </span><span style="color: #ED616F">results</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">map</span><span style="color: #BEBABF">(</span></span>
<span class="line"><span style="color: #BEBABF">        (</span><span style="color: #ED616F; font-style: italic">line</span><span style="color: #BEBABF">) </span><span style="color: #DF61ED">=&gt;</span><span style="color: #BEBABF"> </span><span style="color: #61ED99">`/*    </span><span style="color: #DF61ED">${</span><span style="color: #ED616F">line</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">padEnd</span><span style="color: #BEBABF">(</span><span style="color: #ED616F">longestResultString</span><span style="color: #BEBABF">, </span><span style="color: #61ED99">&#39; &#39;</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}</span><span style="color: #61ED99">    */`</span></span>
<span class="line"><span style="color: #BEBABF">    );</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #ED616F">console</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">log</span><span style="color: #BEBABF">(</span><span style="color: #61ED99">`</span><span style="color: #61EDDF">\n\n</span><span style="color: #61ED99">/</span><span style="color: #DF61ED">${</span><span style="color: #61ED99">&#39;*&#39;</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">repeat</span><span style="color: #BEBABF">(</span><span style="color: #ED616F">longestResultString</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">+</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">10</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}</span><span style="color: #61ED99">/`</span><span style="color: #BEBABF">);</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #ED616F">console</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">log</span><span style="color: #BEBABF">(</span><span style="color: #ED616F">modifiedResults</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">join</span><span style="color: #BEBABF">(</span><span style="color: #61ED99">&#39;</span><span style="color: #61EDDF">\n</span><span style="color: #61ED99">&#39;</span><span style="color: #BEBABF">));</span></span>
<span class="line"><span style="color: #BEBABF">    </span><span style="color: #ED616F">console</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">log</span><span style="color: #BEBABF">(</span><span style="color: #61ED99">`/</span><span style="color: #DF61ED">${</span><span style="color: #61ED99">&#39;*&#39;</span><span style="color: #BEBABF">.</span><span style="color: #61B5ED">repeat</span><span style="color: #BEBABF">(</span><span style="color: #ED616F">longestResultString</span><span style="color: #BEBABF"> </span><span style="color: #61EDDF">+</span><span style="color: #BEBABF"> </span><span style="color: #ED9961">10</span><span style="color: #BEBABF">)</span><span style="color: #DF61ED">}</span><span style="color: #61ED99">/</span><span style="color: #61EDDF">\n\n</span><span style="color: #61ED99">`</span><span style="color: #BEBABF">);</span></span>
<span class="line"><span style="color: #BEBABF">};</span></span>
<span class="line"></span></code></pre>